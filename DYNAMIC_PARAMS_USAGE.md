# 动态参数使用说明

## 功能概述

现在前端已经完全支持动态RAG参数传递和实时调整，包括：

- **Temperature (温度)**：控制模型回答的随机性 (0-2)
- **Top K**：检索相关文档的数量 (1-20) 
- **Messages to Keep**：记忆压缩后保留的历史消息数 (10-100)

## 使用方法

### 1. 设置页面配置
- 访问 "设置" 页面
- 调整所需的参数值
- 点击 "保存设置" 按钮
- 设置会自动保存到浏览器本地存储

### 2. 聊天页面快速调整
- 在聊天页面点击右上角的 ⚙️ 按钮
- 使用滑块实时调整参数
- 参数立即生效，无需保存

### 3. 参数说明

#### Temperature (温度)
- **低值 (0.1-0.3)**：回答更准确、一致，适合事实性问答
- **中值 (0.4-0.7)**：平衡准确性和创造性
- **高值 (0.8-2.0)**：回答更有创造性，适合头脑风暴

#### Top K (检索文档数)
- **低值 (1-3)**：只检索最相关的文档，回答更聚焦
- **中值 (4-6)**：平衡相关性和信息完整性  
- **高值 (7-20)**：检索更多文档，信息更全面但可能有噪音

#### Messages to Keep (保留消息数)
- **低值 (10-20)**：较少的历史记忆，响应更快
- **中值 (20-50)**：适中的历史记忆，平衡性能和上下文
- **高值 (50-100)**：更多历史记忆，更好的对话连贯性

## 技术实现

### 前端架构
1. **useSettings Hook**：全局设置状态管理
2. **类型定义**：TypeScript 类型支持
3. **实时更新**：参数变更立即生效
4. **持久化存储**：设置保存到 localStorage

### 后端集成
1. **动态 Agent 创建**：每次请求按需创建
2. **参数绑定**：LLM 参数通过 `.bind()` 绑定
3. **配置传递**：前端 config 对象传递到后端
4. **默认值处理**：未传参数时使用配置文件默认值

### 数据流
```
前端设置 → useSettings Hook → getRagConfig() → API调用 → 后端处理 → 动态Agent创建
```

## 最佳实践

### 1. 针对不同场景的推荐配置

**严格问答模式**
- Temperature: 0.2
- Top K: 3  
- Messages to Keep: 20

**平衡模式**（默认）
- Temperature: 0.5
- Top K: 5
- Messages to Keep: 30

**创造性对话模式**
- Temperature: 0.8
- Top K: 8
- Messages to Keep: 50

### 2. 性能优化建议
- 避免过高的 Top K 值（超过15），会影响响应速度
- 合理设置 Messages to Keep，过高会消耗更多内存
- 根据实际使用场景调整 Temperature

### 3. 调试技巧
- 使用聊天页面的快速设置进行实时测试
- 观察不同参数组合对回答质量的影响
- 在设置页面进行精确数值调整

## 示例场景

### 学术研究助手
```json
{
  "temperature": 0.2,
  "top_k": 8,
  "messages_to_keep": 40
}
```

### 创意写作助手  
```json
{
  "temperature": 0.8,
  "top_k": 6,
  "messages_to_keep": 25
}
```

### 技术问答助手
```json
{
  "temperature": 0.3,
  "top_k": 5,
  "messages_to_keep": 30
}
```

现在你可以根据不同的需求灵活调整RAG系统的行为，享受更个性化的AI助手体验！